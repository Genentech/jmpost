<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to `jmpost` • jmpost</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to `jmpost`">
<meta property="og:description" content="jmpost">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jmpost</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Intro_to_jmpost.html">Introduction to `jmpost`</a>
    </li>
    <li>
      <a href="../articles/model_fitting.html">Model Fitting</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<!-- start dropdown for versions --> <li class="nav-item dropdown">
        <a href="#" class="nav-link dropdown-toggle"
          data-bs-toggle="dropdown" role="button"
          aria-expanded="false" aria-haspopup="true"
          id="dropdown-versions">Versions</a> <div class="dropdown-menu" aria-labelledby="dropdown-versions"> <a class="dropdown-item" data-toggle="tooltip" title="" href="https://Genentech.github.io/jmpost/main">main</a> </div></li>
<!-- end dropdown for versions -->
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to <code>jmpost</code>
</h1>
            <h3 data-toc-skip class="subtitle">
<code>J</code>oint
<code>M</code>odels for <code>P</code>redicting <code>O</code>verall
<code>S</code>urvival <code>T</code>rajectories</h3>
                        <h4 data-toc-skip class="author">Georgios
Kazantzidis</h4>
                        <h4 data-toc-skip class="author">Daniel Sabanés
Bové</h4>
                        <h4 data-toc-skip class="author">Xiaoyan
Fang</h4>
            
      
      
      <div class="hidden name"><code>Intro_to_jmpost.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In clinical development of new cancer medicines a key challenge is to
decide on the next steps after having collected the initial data in
Phase 1 studies. In phase 1 studies patients are followed until the
cancer is growing again (progression event). Thus, reliable overall
survival data are not available. However, we can use additional
information from previous clinical trials or real-world data to
understand the time between progression and death. Specifically, we can
correlate the tumor response data, that are longitudinal measurements,
(i.e. the shrinkage and growth of tumor lesions over time) with the
overall survival of the patients or their hazard ratios <span class="citation">(Beyer et al. 2020)</span>. Thereby we can predict the
overall survival in our Phase 1 studies and therefore make better
decisions <span class="citation">(Kerioui et al. 2020)</span>.</p>
<p>The sum of the longest diameters (SLD) of the cancer lesions provides
an effective and representative biomarker for longitudinal measurements
in solid cancer. SLD is relatively easy to measure with reasonable
accuracy while also being a good representative of the development of
cancer.</p>
<p>The association between the longitudinal data and the overall
survival can be achieved in different ways. The predicted SLD value or
its first derivative over time can be directly treated as the linking
factor in the hazard model for survival. Other factors such as the time
to growth, the tumor shrinkage rate or the tumor growth rate can also be
used to associate longitudinal outcomes with overall survival.</p>
<p>Bayesian methodology provides an important tool for the analysis of
similar data. Firstly, the use of historical data from previous trials
is improving the performance of the models. Secondly, prior definition
allows the adjustment of the models according to the specific factors of
each analysis.</p>
<p>Although these statistical methods provide significant advantages in
decision making processes in cancer drug development, their
implementation is relatively intricate and time consuming. Compared to
other R-packages such as <code>joineR</code> and <code>jmbayes</code>,
<code>jmpost</code> provides the flexibility of non-linear mixed effects
modeling for the longitudinal part of the joint model. Non-linear
parametrization respects the biological implications of clinical trials
in oncology where the observed tumor response usually follows non-linear
patterns.</p>
</div>
<div class="section level2">
<h2 id="minimal-usage">Minimal usage<a class="anchor" aria-label="anchor" href="#minimal-usage"></a>
</h2>
<p>The minimal usage of the <code>jmpost</code> package calls example
stan code already provided in the repository of the package. The
following chunk illustrates the absolute minimal usage of the
package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The longitudinal submodel</span></span>
<span><span class="va">my_long_mod</span> <span class="op">&lt;-</span> <span class="fu">LongMod</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># The templated survival submodel</span></span>
<span><span class="va">my_temp_os</span> <span class="op">&lt;-</span> <span class="fu">LogLogisticOs</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># The link between longitudinal and OS models</span></span>
<span><span class="va">my_link</span> <span class="op">&lt;-</span> <span class="fu">ttgLink</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># The complete survival submodel</span></span>
<span><span class="va">my_os</span> <span class="op">&lt;-</span> <span class="fu">parametrize</span><span class="op">(</span>osmod <span class="op">=</span> <span class="va">my_temp_os</span>, link <span class="op">=</span> <span class="va">my_link</span><span class="op">)</span></span>
<span><span class="co"># The full model</span></span>
<span><span class="fu"><a href="../reference/JointModel-class.html">JointModel</a></span><span class="op">(</span>long <span class="op">=</span> <span class="va">my_long_mod</span>, os <span class="op">=</span> <span class="va">my_os</span><span class="op">)</span></span></code></pre></div>
<p>The final two steps of the package workflow are not available yet:
First, the running step of the model, where the user calls the defined
model along with the data and the preferred options. Secondly, the
summary report of the model run.</p>
</div>
<div class="section level2">
<h2 id="customizing-the-analysis">Customizing the analysis<a class="anchor" aria-label="anchor" href="#customizing-the-analysis"></a>
</h2>
<p><code>jmpost</code> is a package aiming to optimize the procedure of
developing a new Bayesian joint model. The package provides complete
examples of joint modeling code. Here we explain the workflow of the
package <code>jmpost</code> using <code>stan</code> libraries as an
example.</p>
<p>Figure~1 illustrates the main workflow of the <code>jmpost</code>
package. Three objects need to be combined for the construction of the
full Bayesian joint model. The longitudinal sub-model, including all the
required information for the modeling of the longitudinal measurements,
the survival sub-model, including information of for the time to event
data and the link or association factor, containing information for the
conection of the two sub-models.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Long_mod</span> <span class="op">&lt;-</span> <span class="fu">LongModel</span><span class="op">(</span></span>
<span>    stan <span class="op">=</span> <span class="fu"><a href="../reference/StanModule-class.html">StanModule</a></span><span class="op">(</span></span>
<span>        functions <span class="op">=</span> <span class="st">"exp_long_functions.stan"</span>,</span>
<span>        data <span class="op">=</span> <span class="st">"exp_long_data.stan"</span>,</span>
<span>        priors <span class="op">=</span> <span class="fu">long_prior</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        model <span class="op">=</span> <span class="st">""</span>,</span>
<span>        inits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        parameters <span class="op">=</span> <span class="st">"exp_long_parameters.stan"</span>,</span>
<span>        transformed_parameters <span class="op">=</span> <span class="st">"exp_long_transformed_parametes.stan"</span>,</span>
<span>        generated_quantities <span class="op">=</span> <span class="st">""</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The construction of the different parts of the model is flexible.
Here, we create the longitudinal part by calling the
<code>LongModel</code> constructor. <code>LongModel</code> identifies
the type of the sub-model whereas the helper constructor
<code>StanModule</code> is responsible for the actual stan code. The
created object contains six compartments containing different parts of
the stan code (functions, data, priors, model, parameters, transformed
parameters and generated quantities) while also <code>inits</code> which
contains the initial values for the Markov Chain Monte Carlo run. The
user is able to populate the different parts of the object with stan
code either by providing the names of the stan files contained in the
<code>jmpost</code> directory, the full paths of stan files outside the
<code>jmpost</code> direcotry or by providing stan code in text form
(code chunk below).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_stan</span> <span class="op">&lt;-</span> <span class="fu">LongModel</span><span class="op">(</span></span>
<span>    stan <span class="op">=</span> <span class="fu"><a href="../reference/StanModule-class.html">StanModule</a></span><span class="op">(</span></span>
<span>        functions <span class="op">=</span> <span class="st">"type stan code here;"</span>,</span>
<span>        data <span class="op">=</span> <span class="st">"type stan code here;"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Figure~2 depicts the structure of a <code>StanModule</code> object.
Gray coloured cells indicate character strings containing stan code
whereas yellow coloured cells mark list objects.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/StanModule-class.html">StanModule</a></span><span class="op">(</span>functions <span class="op">=</span> <span class="st">""</span>,</span>
<span>           data <span class="op">=</span> <span class="st">""</span>,</span>
<span>           model <span class="op">=</span> <span class="st">""</span>,</span>
<span>           parameters <span class="op">=</span> <span class="st">""</span>,</span>
<span>           transformed_parameters <span class="op">=</span> <span class="st">""</span>,</span>
<span>           generated_quantities <span class="op">=</span> <span class="st">""</span>,</span>
<span>           priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>           inits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The <code>jmpost</code> repository contains stan code for the
creation of a specific stan model. The user is able to populate the
longitudinal object <code>Long_mod</code> either by specifying the stan
files containing the relevant code of the section or by directly typing
the stan code into R. We split the model section of the stan file into
two parts, the <code>priors</code> and the <code>model</code>.
<code>Priors</code> contain a list with the names of the parameters and
their prior distribution definitions while <code>model</code> is a
character that contains model relevant information such us the
definition of the likelihood. The list of priors should be a named list
of strings where each element represents the stan code for the
definition of the desired density.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/StanModule-class.html">StanModule</a></span><span class="op">(</span>priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"param_A"</span> <span class="op">=</span> <span class="st">"normal(0,1);"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The user can modify the prior list at any point during the
workflow.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior_set</span><span class="op">@</span><span class="va">priors</span><span class="op">$</span><span class="va">param_A</span> <span class="op">&lt;-</span> <span class="st">"normal(1,1);"</span></span></code></pre></div>
<p>Call of the object prints the stan code of all the sections of the
object.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Long_mod</span></span></code></pre></div>
<p>The overall survival object contails all ther information for the
parametrisation of the second sub-model of the joint model. The overall
survival object has identical structure as the Longitudinal object
(Figure~2). The slots <code>functions</code>, <code>parameters</code>,
<code>model</code>, <code>transformed parameters</code> and
<code>generated quantities</code> should be provided with stan code
whereas <code>priors</code> and <code>initial values</code> should be
filled with lists. An example with Log-logistic parametrisation of the
overall survival sub-modlel object is provided in
<code>LogLogisticOS()</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_os</span> <span class="op">&lt;-</span> <span class="fu">LogLogisticOs</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Although the Longitudinal and the Survival object identical
structures, the contained stan code has some fundamental differences.
The functions contained in the overall survival object depend on the
parametrisation of the longitudinal part. Thus, in order to complete the
stan code of the former object, additional information is required. The
required details are provided to the overall survival object through the
link object. The link is an object containing the parametrisation of the
longitudinal sub-model, that will be used as part of the overall
survival object.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">link</span> <span class="op">&lt;-</span> <span class="fu">HazardLink</span><span class="op">(</span></span>
<span>    parameters <span class="op">=</span> <span class="st">"beta_ttg"</span>,</span>
<span>    contribution <span class="op">=</span> <span class="st">"* rep_matrix(ttg(psi_ks, psi_kg, psi_phi), rows(time))"</span>,</span>
<span>    stan <span class="op">=</span> <span class="fu"><a href="../reference/StanModule-class.html">StanModule</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Link objects or association factor, contain the slots of
<code>parameters</code>, <code>contribution</code> and
<code>stan</code>. Here, the slot <code>parameters</code> is the name of
the linking parameter of the two sub-models. <code>Contribution</code>
contains the stan code relevant to the linking parameter.
<code>Parameters</code> and <code>contribution</code> contain all the
information required for the completion of the overall survival
model.</p>
<p>The merge of the <code>Longitudinal</code>,
<code>Overall survival</code> and <code>link</code> object takes place
in two parts. First, the parameterisation of the overall survival
sub-model needs to be completed using the information from the link
object (part 1).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">os</span> <span class="op">&lt;-</span> <span class="fu">parametrize</span><span class="op">(</span>osmod <span class="op">=</span> <span class="va">temp_os</span>, link <span class="op">=</span> <span class="va">link</span><span class="op">)</span></span></code></pre></div>
<p>Secondly, the <code>Longitudinal</code> and <code>Survival</code>
sub-models need to be combined (part 2). Function
<code>JointModel</code> merges the two sub-models, creates a character
containing the full stan model, creates a stan file with the produced
model and checks the functionality of the produced file. Mistakes in the
stan file will be reported from the <code>JointModel</code> call.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/JointModel-class.html">JointModel</a></span><span class="op">(</span>long <span class="op">=</span> <span class="va">Long_mod</span>, os <span class="op">=</span> <span class="va">os</span><span class="op">)</span></span></code></pre></div>
<p><code>jm</code> object contains all the complete stan code for the
joint model. <code>jmpost</code> uses the package <code>cmdstanr</code>
for the compilation of the stan model. Although the stan code of the
model is obtained in <code>jm</code>, additional information for the
model run should be provided.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jm_options</span> <span class="op">&lt;-</span> <span class="fu">mcmc_options</span><span class="op">(</span>chains <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                           parallel_chains <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                           iter_warmup <span class="op">=</span> <span class="fl">200</span>,</span>
<span>                           iter_sampling <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                           max_treedepth <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                           adapt_delta <span class="op">=</span> <span class="fl">.9</span>,</span>
<span>                           gauss_legendre <span class="op">=</span> <span class="fu">gauss_legendre</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><code>mcmc_options</code> object contains technical information
relevant to the model run. Most of the options are borrowed from the
package <code>cmdstanr</code> except from the
<code>gauss_legendre</code> that defines the integration parameters.</p>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<div class="section level4">
<h4 id="sld-model">SLD model<a class="anchor" aria-label="anchor" href="#sld-model"></a>
</h4>
<p><span class="math display">\[\begin{align}
y_{ij} \sim N(SLD_{ij}, SLD^2_{ij}\sigma^2)
\end{align}\]</span></p>
Where:
</div>
<div class="section level4">
<h4 id="expected-sld">Expected SLD<a class="anchor" aria-label="anchor" href="#expected-sld"></a>
</h4>
<hr>
<span class="math display">\[\begin{align}
SLD_{ij} = b_i[\phi_ie^{-s_it_{ij}}+(1-\phi_i)e^{g_it_{ij}}]
\end{align}\]</span> Where:
</div>
<div class="section level4">
<h4 id="the-sld-parameters">The SLD parameters<a class="anchor" aria-label="anchor" href="#the-sld-parameters"></a>
</h4>
<hr>
<p><span class="math display">\[\begin{align*}
\phi_i = logit^{-1}(logit(m_{\phi l_i}) + \eta_{\phi i}*\omega_{\phi})
\\
s_i = exp(ln(m_{sl_i})+\eta_{si}*\omega_s) \\
g_i = exp(lm(m_{gl_i}) +\eta_{gi}*\omega_g) \\
b_i = exp(ln(m_{bl_i}) + \eta_{bi}*\omega_b)
\end{align*}\]</span></p>
Where:
</div>
<div class="section level4">
<h4 id="the-sld-hyper-parameters">The SLD Hyper-parameters<a class="anchor" aria-label="anchor" href="#the-sld-hyper-parameters"></a>
</h4>
<hr>
<p><span class="math display">\[\begin{align*}
m_{sl_i} \sim Lognormal(\mu_s,\sigma_s) \\
m_{gl_i} \sim Lognormal(\mu_g,\sigma_g) \\
logit(m_{\phi} l_i) \sim N(logit(\mu_{\phi}), \sigma_{\phi})
\end{align*}\]</span></p>
Where:
</div>
<div class="section level4">
<h4 id="survival-model">Survival model<a class="anchor" aria-label="anchor" href="#survival-model"></a>
</h4>
<hr>
<p><span class="math display">\[\begin{align*}
h_i(t) = h_0(t)e^{\beta f_i(t)}e^{\gamma G_i} e^{\beta_cX_i}
\end{align*}\]</span></p>
Where:
</div>
<div class="section level4">
<h4 id="baseline-hazard">Baseline hazard<a class="anchor" aria-label="anchor" href="#baseline-hazard"></a>
</h4>
<hr>
<p><span class="math display">\[\begin{align*}
t \sim LogLogistic(\lambda,p) \\
f_0(t) = \frac{\lambda p (\lambda t)^{p-1}}{(1+(\lambda t)^p)^2} \\
h_0(t) = \frac{\lambda p (\lambda t)^{p-1}}{1+(\lambda t)^p} \\
S_0(t) = \frac{1}{1+(\lambda t)^p}
\end{align*}\]</span></p>
Where:
</div>
<div class="section level4">
<h4 id="time-to-growth">Time to growth<a class="anchor" aria-label="anchor" href="#time-to-growth"></a>
</h4>
<hr>
<p><span class="math display">\[\begin{align*}
G_i = \frac{logit(\phi_i)+log(s_ig_i^{-1})}{s_i+g_i}
\end{align*}\]</span></p>
Where:
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-beyer2020multistate" class="csl-entry">
Beyer, Ulrich, David Dejardin, Matthias Meller, Kaspar Rufibach, and
Hans Ulrich Burger. 2020. <span>“A Multistate Model for Early
Decision-Making in Oncology.”</span> <em>Biometrical Journal</em> 62
(3): 550–67.
</div>
<div id="ref-kerioui2020bayesian" class="csl-entry">
Kerioui, Marion, Francois Mercier, Julie Bertrand, Coralie Tardivon,
René Bruno, Jérémie Guedj, and Solène Desmée. 2020. <span>“Bayesian
Inference Using Hamiltonian Monte-Carlo Algorithm for Nonlinear Joint
Modeling in the Context of Cancer Immunotherapy.”</span> <em>Statistics
in Medicine</em> 39 (30): 4853–68.
</div>
</div>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Craig Gower-Page, Georgios Kazantzidis, Xiaoyan Fang, Daniel Sabanes Bove, F. Hoffmann-La Roche AG.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
